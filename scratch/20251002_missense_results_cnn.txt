[SMOKE] Label coverage (full): train n=41372 (+:13511, -:27861, pos%=0.327)
[SMOKE] Label coverage (full): val n=5631 (+:2007, -:3624, pos%=0.356)
[SMOKE] Label coverage (full): test n=5170 (+:2053, -:3117, pos%=0.397)


Numbers to beat: missense (window=127)

TEST metrics:
{'n': 5170, 'accuracy': 0.8928433268858801, 'precision': 0.8503973819541842, 'recall': 0.8860204578665368, 'f1': 0.8678435114503816, 'auc_roc': 0.9581664960984974, 'auc_pr': 0.9434083492516359}

VAL metrics:
{'n': 5631, 'accuracy': 0.870715681051323, 'precision': 0.8020784128483703, 'recall': 0.8460388639760837, 'f1': 0.8234723569350145, 'auc_roc': 0.9391246943644266, 'auc_pr': 0.8973571162825921}
Confusion: [[3205, 419], [309, 1698]]

{'test': {'accuracy': 0.8928433268858801,
          'auc_pr': 0.9434083492516359,
          'auc_roc': 0.9581664960984974,
          'confusion_matrix': [[2797, 320], [234, 1819]],
          'f1': 0.8678435114503816,
          'n': 5170,
          'precision': 0.8503973819541842,
          'predictions_path': '/media/array/Sync/Repositories/VarCLIP/artifacts/missense/qwen3/test_scored.feather',
          'recall': 0.8860204578665368,
          'report': '              precision    recall  f1-score   support\n'
                    '\n'
                    '      Benign      0.923     0.897     0.910      3117\n'
                    '  Pathogenic      0.850     0.886     0.868      2053\n'
                    '\n'
                    '    accuracy                          0.893      5170\n'
                    '   macro avg      0.887     0.892     0.889      5170\n'
                    'weighted avg      0.894     0.893     0.893      5170\n',
          'split': 'test'},
 'val': {'accuracy': 0.870715681051323,
         'auc_pr': 0.8973571162825921,
         'auc_roc': 0.9391246943644266,
         'confusion_matrix': [[3205, 419], [309, 1698]],
         'f1': 0.8234723569350145,
         'n': 5631,
         'precision': 0.8020784128483703,
         'predictions_path': '/media/array/Sync/Repositories/VarCLIP/artifacts/missense/qwen3/val_scored.feather',
         'recall': 0.8460388639760837,
         'report': '              precision    recall  f1-score   support\n'
                   '\n'
                   '      Benign      0.912     0.884     0.898      3624\n'
                   '  Pathogenic      0.802     0.846     0.823      2007\n'
                   '\n'
                   '    accuracy                          0.871      5631\n'
                   '   macro avg      0.857     0.865     0.861      5631\n'
                   'weighted avg      0.873     0.871     0.871      5631\n',
         'split': 'val'}}

--- (window=255)
TEST metrics:
{'n': 5170, 'accuracy': 0.8901353965183753, 'precision': 0.8976968398500268, 'recall': 0.8163662932294203, 'f1': 0.8551020408163266, 'auc_roc': 0.95822705053334, 'auc_pr': 0.942976032143368}

VAL metrics:
{'n': 5631, 'accuracy': 0.8808382170129639, 'precision': 0.8508403361344538, 'recall': 0.8071748878923767, 'f1': 0.828432625926873, 'auc_roc': 0.9454091969497488, 'auc_pr': 0.9083608309931134}

{'test': {'accuracy': 0.8901353965183753,
          'auc_pr': 0.942976032143368,
          'auc_roc': 0.95822705053334,
          'confusion_matrix': [[2926, 191], [377, 1676]],
          'f1': 0.8551020408163266,
          'n': 5170,
          'precision': 0.8976968398500268,
          'predictions_path': '/media/array/Sync/Repositories/VarCLIP/artifacts/missense/qwen3/test_scored.feather',
          'recall': 0.8163662932294203,
          'report': '              precision    recall  f1-score   support\n'
                    '\n'
                    '      Benign      0.886     0.939     0.912      3117\n'
                    '  Pathogenic      0.898     0.816     0.855      2053\n'
                    '\n'
                    '    accuracy                          0.890      5170\n'
                    '   macro avg      0.892     0.878     0.883      5170\n'
                    'weighted avg      0.891     0.890     0.889      5170\n',
          'split': 'test'},
 'val': {'accuracy': 0.8808382170129639,
         'auc_pr': 0.9083608309931134,
         'auc_roc': 0.9454091969497488,
         'confusion_matrix': [[3340, 284], [387, 1620]],
         'f1': 0.828432625926873,
         'n': 5631,
         'precision': 0.8508403361344538,
         'predictions_path': '/media/array/Sync/Repositories/VarCLIP/artifacts/missense/qwen3/val_scored.feather',
         'recall': 0.8071748878923767,
         'report': '              precision    recall  f1-score   support\n'
                   '\n'
                   '      Benign      0.896     0.922     0.909      3624\n'
                   '  Pathogenic      0.851     0.807     0.828      2007\n'
                   '\n'
                   '    accuracy                          0.881      5631\n'
                   '   macro avg      0.874     0.864     0.869      5631\n'
                   'weighted avg      0.880     0.881     0.880      5631\n',
         'split': 'val'}}


Ablation summary [val]
Mode                N      Acc       F1    ROC-AUC     PR-AUC
------------------------------------------------------
cond+prompt      5631   0.8808   0.8284     0.9454     0.9084
cond_only        5631   0.7723   0.5499     0.8976     0.8369
cond_zero_prot   5631   0.7146   0.6958     0.8623     0.7594
prompt_only      5631   0.7146   0.6958     0.8623     0.7594
prompt_no_hgvsp   5631   0.8711   0.8065     0.9390     0.8953
prompt_no_hgvsc   5631   0.8800   0.8251     0.9447     0.9070
prompt_no_gene   5631   0.8098   0.7386     0.8848     0.8203
cond+noise       5631   0.7929   0.7268     0.8682     0.7725

Δ vs cond+prompt:
- cond_only     ΔAcc=-0.1085  ΔF1=-0.2786  ΔROC-AUC=-0.0478  ΔPR-AUC=-0.0715
- cond_zero_prot  ΔAcc=-0.1662  ΔF1=-0.1326  ΔROC-AUC=-0.0831  ΔPR-AUC=-0.1490
- prompt_only   ΔAcc=-0.1662  ΔF1=-0.1326  ΔROC-AUC=-0.0831  ΔPR-AUC=-0.1490
- prompt_no_hgvsp  ΔAcc=-0.0098  ΔF1=-0.0219  ΔROC-AUC=-0.0065  ΔPR-AUC=-0.0130
- prompt_no_hgvsc  ΔAcc=-0.0009  ΔF1=-0.0034  ΔROC-AUC=-0.0008  ΔPR-AUC=-0.0014
- prompt_no_gene  ΔAcc=-0.0710  ΔF1=-0.0898  ΔROC-AUC=-0.0607  ΔPR-AUC=-0.0881
- cond+noise    ΔAcc=-0.0879  ΔF1=-0.1016  ΔROC-AUC=-0.0772  ΔPR-AUC=-0.1358

--- ESM C 
VAL metrics:
{'n': 5631, 'accuracy': 0.9017936423370627, 'precision': 0.8810272536687631, 'recall': 0.8375685102142502, 'f1': 0.8587484035759898, 'auc_roc': 0.9577460538226582, 'auc_pr': 0.9317748409085297}
Confusion: [[3397, 227], [326, 1681]]

TEST metrics:
{'n': 5170, 'accuracy': 0.9179883945841393, 'precision': 0.9209302325581395, 'recall': 0.8679980516317584, 'f1': 0.8936810431293881, 'auc_roc': 0.970320357182092, 'auc_pr': 0.9599424399183856}
Confusion: [[2964, 153], [271, 1782]]

{'test': {'accuracy': 0.9179883945841393,
          'auc_pr': 0.9599424399183856,
          'auc_roc': 0.970320357182092,
          'confusion_matrix': [[2964, 153], [271, 1782]],
          'f1': 0.8936810431293881,
          'n': 5170,
          'precision': 0.9209302325581395,
          'predictions_path': '/media/array/Sync/Repositories/VarCLIP/artifacts/missense/qwen3/test_scored.feather',
          'recall': 0.8679980516317584,
          'report': '              precision    recall  f1-score   support\n'
                    '\n'
                    '      Benign      0.916     0.951     0.933      3117\n'
                    '  Pathogenic      0.921     0.868     0.894      2053\n'
                    '\n'
                    '    accuracy                          0.918      5170\n'
                    '   macro avg      0.919     0.909     0.913      5170\n'
                    'weighted avg      0.918     0.918     0.918      5170\n',
          'split': 'test'},
 'val': {'accuracy': 0.9017936423370627,
         'auc_pr': 0.9317748409085297,
         'auc_roc': 0.9577460538226582,
         'confusion_matrix': [[3397, 227], [326, 1681]],
         'f1': 0.8587484035759898,
         'n': 5631,
         'precision': 0.8810272536687631,
         'predictions_path': '/media/array/Sync/Repositories/VarCLIP/artifacts/missense/qwen3/val_scored.feather',
         'recall': 0.8375685102142502,
         'report': '              precision    recall  f1-score   support\n'
                   '\n'
                   '      Benign      0.912     0.937     0.925      3624\n'
                   '  Pathogenic      0.881     0.838     0.859      2007\n'
                   '\n'
                   '    accuracy                          0.902      5631\n'
                   '   macro avg      0.897     0.887     0.892      5631\n'
                   'weighted avg      0.901     0.902     0.901      5631\n',
         'split': 'val'}}


Ablation summary [val]
Mode                N      Acc       F1    ROC-AUC     PR-AUC
------------------------------------------------------
cond+prompt      5631   0.9018   0.8587     0.9577     0.9318
cond_only        5631   0.8304   0.7015     0.9254     0.8856
cond_zero_prot   5631   0.6663   0.6631     0.8339     0.7429
prompt_only      5631   0.6663   0.6631     0.8339     0.7429
prompt_no_hgvsp   5631   0.8974   0.8496     0.9557     0.9282
prompt_no_hgvsc   5631   0.9011   0.8574     0.9579     0.9320
prompt_no_gene   5631   0.8645   0.8052     0.9295     0.8907
cond+noise       5631   0.7402   0.6417     0.7963     0.6887

Δ vs cond+prompt:
- cond_only     ΔAcc=-0.0714  ΔF1=-0.1573  ΔROC-AUC=-0.0324  ΔPR-AUC=-0.0462
- cond_zero_prot  ΔAcc=-0.2355  ΔF1=-0.1957  ΔROC-AUC=-0.1238  ΔPR-AUC=-0.1888
- prompt_only   ΔAcc=-0.2355  ΔF1=-0.1957  ΔROC-AUC=-0.1238  ΔPR-AUC=-0.1888
- prompt_no_hgvsp  ΔAcc=-0.0044  ΔF1=-0.0092  ΔROC-AUC=-0.0021  ΔPR-AUC=-0.0035
- prompt_no_hgvsc  ΔAcc=-0.0007  ΔF1=-0.0013  ΔROC-AUC=+0.0001  ΔPR-AUC=+0.0002
- prompt_no_gene  ΔAcc=-0.0373  ΔF1=-0.0535  ΔROC-AUC=-0.0282  ΔPR-AUC=-0.0411
- cond+noise    ΔAcc=-0.1616  ΔF1=-0.2171  ΔROC-AUC=-0.1615  ΔPR-AUC=-0.2430


